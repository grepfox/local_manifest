#!/bin/bash

# Remove old local manifests
rm -rf .repo/local_manifests

# Nuke trees
rm -rf vendor/xiaomi/vayu
rm -rf device/xiaomi/vayu

# Initialize repo with YAAP manifest
repo init -u https://github.com/yaap/manifest -b sixteen --git-lfs --depth=1

# Clone local manifests
git clone https://github.com/grepfox/local_manifest -b axion .repo/local_manifests

# Remove old prebuilts and hardware directories
rm -rf prebuilts/clang/host/linux-x86

# Remove hardware repos
rm -rf hardware

# Run resync script
#/opt/crave/resync.sh
#repo sync -j8 --force-sync

# Clean and replace more directories
rm -rf hardware/xiaomi
git clone https://github.com/LineageOS/hardware_xiaomi hardware/xiaomi -b lineage-22.2

# Source environment and lunch target
source build/envsetup.sh
axion panther va
axionSync

# Start the build
#m installclean
ax -br -j$(nproc)

# Display any error logs
echo "Here is your error"
cat out/error.log
